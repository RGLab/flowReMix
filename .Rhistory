weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[27]
data <- subset(data, population == leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
dat$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  treatment,
sub.population = population,
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[27]
data <- subset(data, population == leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
dat$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  treatment,
sub.population = population,
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[27]
data <- subset(data, population == leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
dat$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[27]
data <- subset(data, population == leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
dat$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
data
data$treatment
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[27]
data <- subset(data, population == leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[27]
data <- subset(data, population == leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  visitno,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = visitno,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
fit$levelProbs
fit$posteriors
fit$covariance
fit$altRandomEffects
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[27]
data <- subset(data, population == leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  visitno,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = visitno,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
initFormula
dat$id
dat$visitno
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[27]
data <- subset(data, population == leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  visitno,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = visitno,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
glmformula
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
dat$treatment
glmFits
dat$tempTreatment
sub.population
dataForGlm <- data.frame(data.table::rbindlist(databyid))
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
dataByPopulation
dataByPopulation$`4+/IL2+`
dat$treatment
dat$treatment <- 0
dat$treatment
?factor
levels(dat$treatment)
dat$treatment
data$treatment
levels(data$treatment)
dataByPopulation[[j]]$treatment <- factor(0, levels = levels(dataByPopulation[[j]]$tempTreatment))
library(flowReMix)
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
newNullEta <- predict(glmFits[[j]], newdata = dataByPopulation[[j]])
dataByPopulation[[1]]$treatment
factor(0, levels = levels(dataByPopulation[[j]]$tempTreatment))
dataByPopulation[[j]]$treatment <- factor(0, levels = levels(dataByPopulation[[j]]$tempTreatment))
dataByPopulation[[j]]$treatment
is.factor(dataByPopulation$treatment)
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
is.factor(dataByPopulation$treatment)
library(flowReMix)
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 20, tol = 1e-03)
fit <- flowRegressionMixture(count ~  treatment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 100, tol = 1e-03)
fit <- flowRegressionMixture(count ~  treatment * stim,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 100, tol = 1e-03)
fit$coefficients
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[28]
data <- subset(data, population == leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  treatment * stim,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 100, tol = 1e-03)
data$population
names(data)
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[28]
data <- subset(data, population == leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  treatment * stim + experiment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 100, tol = 1e-03)
fit$coefficients
length(fit$covariance)
length(fit$coefficients)
length(fit$coefficients[[1]])
dim(data)
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[26:28]
data <- subset(data, population %in% leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  treatment * stim + experiment,
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 100, tol = 1e-03)
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[26:28]
data <- subset(data, population %in% leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  population/(treatment * stim + experiment),
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 100, tol = 1e-03)
data$population
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[26:28]
data <- subset(data, population %in% leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  (treatment * stim + experiment),
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 100, tol = 1e-03)
fit$covariance
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[26:28]
data <- subset(data, population %in% leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  (treatment * stim + experiment),
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = FALSE,
maxIter = 50, tol = 1e-03)
fit$covariance
cov2cor(fit$covariance)
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[26:28]
data <- subset(data, population %in% leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  (treatment * stim + experiment),
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = TRUE,
maxIter = 50, tol = 1e-03)
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[26:28]
data <- subset(data, population %in% leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  (treatment * stim + experiment),
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = TRUE,
maxIter = 30, tol = 1e-03)
fit$covariance
cov2cor(fit$covariance)
fit$coefficients
sapply(fit$coefficients)
sapply(fit$coefficients, function(x) x)
data$visitno
unique(malaria$visitno)
data <- malaria
leaves <- unique(data$population)
leaves <- leaves[!(leaves %in% unique(data$parent))]
leaf <- leaves[2:4]
data <- subset(data, population %in% leaf)
data$visitno <- as.numeric(factor(data$visitno))
data$visitno <- factor(data$visitno - min(data$visitno))
data$treatment <- data$visitno
fit <- flowRegressionMixture(count ~  (treatment * stim + experiment),
sub.population = factor(data$population),
N = parentcount, id =  ptid,
data = data,
treatment = treatment,
weights = NULL,
rate = 1, updateLag = 5,
nsamp = 200,
centerCovariance = TRUE,
maxIter = 30, tol = 1e-03)
sapply(fit$coefficients, function(x) x)
leaves
leaves
?mvtnrom
?mvtnorm
require(mvtnorm)
?pmvnorm
